angular.module("myApp",[]).run(["$translate","$log","realTimeService","randomService",function(a,b,c,d){"use strict";function e(c){function e(a){P=new window.FPSMeter(document.body,{graph:1,theme:"colorful",position:"absolute",left:"auto",top:"0%",right:"0%",bottom:"auto"}),U=a.yourPlayerIndex,T=a.playersInfo,V=a.matchController,R=!0,S=1===T.length,J=0,K=[],G=[],I=[],M=null,N=!1,O=[];for(var b=0;b<T.length;b++)G[b]=[],I[b]=0;H=G[U],y(o),L=(new Date).getTime(),t()}function i(a){for(var b=0;b<K.length;b++)if(a.x1===K[b].x1&&a.y1===K[b].y1&&a.x2===K[b].x2&&a.y2===K[b].y2)return b;return-1}function p(a){var b=a.fromPlayerIndex,c=a.message,d=angular.fromJson(c);G[b].push(d.a),I[b]=d.s;var e=i(d.a);K[e].found||(K[e].found=!0,J--)}function q(a){I=a,R=!1,u()}function r(a){if(!S&&R){var b=angular.toJson({s:I[U],a:{x1:Y,y1:Z,x2:$,y2:_}});a?V.sendReliableMessage(b):V.sendUnreliableMessage(b)}}function s(){R&&(R=!1,V.endMatch(I))}function t(){u(),Q=setInterval(z,l)}function u(){clearInterval(Q)}function v(a){switch(a){case 0:return{dx:0,dy:1};case 1:return{dx:1,dy:1};case 2:return{dx:1,dy:0};case 3:return{dx:1,dy:-1};case 4:return{dx:0,dy:-1};case 5:return{dx:-1,dy:-1};case 6:return{dx:-1,dy:0};case 7:return{dx:-1,dy:1}}}function w(a){var b,c,e,f,g,h,i,j,l=!1,m=0,n=200;if(!(a.length>k)){for(;!l;){b=d.randomFromTo(J+10*(3*m+1),0,k),c=d.randomFromTo(J+10*(3*m+2),0,k),i=d.randomFromTo(J+10*(3*m+3),0,8);var o=v(i);if(g=o.dx,h=o.dy,e=b+g*(a.length-1),f=c+h*(a.length-1),m++,m>n)return;if(!(f>=k||0>f||e>=k||0>e)){j=!1;for(var p=b,q=c,r=0;r<a.length;r++)""!==O[p][q]&&O[p][q]!==a.substring(r,r+1)&&(j=!0),p+=g,q+=h;if(!j){for(p=b,q=c,r=0;r<a.length;r++)O[p][q]=a.substring(r,r+1).toUpperCase(),p+=g,q+=h;l=!0}}}return{x1:b,y1:c,x2:e,y2:f}}}function x(){var a,b,c=6020;for(a=0;k>a;a++)for(b=0;k>b;b++)""===O[a][b]&&(O[a][b]=String.fromCharCode(d.randomFromTo(c,65,90)).toUpperCase(),c++)}function y(a){var c,e,f;for(c=0;k>c;c++)for(O[c]=[],e=0;k>e;e++)O[c][e]="";for(var g=d.randomFromTo(J,0,a.length),h=0,i=g;h<a.length&&10>J;h++){var j=a[i].toLowerCase().replace(/\s/,"");if(f=w(j)){var l={x1:f.x1,y1:k-1-f.y1,x2:f.x2,y2:k-1-f.y2,content:a[i],found:!1};K.push(l),b.info(l),J++,i=(i+1)%a.length}else i=(i+1)%a.length}x()}function z(){if(P.tickStart(),R){var b=Math.floor(((new Date).getTime()-L)/1e3);if(3>b){B();var c=3-b,d=m[U];X.fillStyle=d,X.font="80px sans-serif",X.fillText(""+c,f/2,g/2),X.font="20px sans-serif";var e=a("YOUR_PLAYER_COLOR_IS",{color:a(d.toUpperCase())});return X.fillText(e,f/4-30,g/4-30),void P.tick()}B();var h;if(null!==M&&(h=M,D([h],U)),N){M=null,N=!1;var j=i(h);if(-1===j)return;if(K[j].found)return;K[j].found=!0,J--,I[U]++,H=G[U],H.push(h),G[U]=H,r(!0),0===J&&s(),B(),P.tick()}}}function A(){var a,b;X.font="20px monospace",X.fillStyle="#8B7355",X.textBaseline="middle";for(var c=0;k>c;c++){b=(k-c)*h-h/2;for(var d=0;k>d;d++){a=d*h+h/4;var e=O[d][c];X.fillText(e,a,b)}}a=(k+.25)*h;for(var f=0;f<K.length;f++)b=f*h+h/2,X.font=K[f].found?"italic 12px Arial":"bold 12px Arial",X.fillStyle=K[f].found?"#CDAA7D":"#8B7355",X.fillText(K[f].content,a,b)}function B(){X.fillStyle="#F5F5DC",X.fillRect(0,0,f,g),X.strokeStyle="#8B4513",X.lineWidth=2,X.strokeRect(0,0,g,g),X.strokeRect(g,0,f-g,g),A();var b;for(b=0;b<G.length;b++)b!==U&&D(G[b],b);for(D(H,U),b=0;b<I.length;b++){X.font="12px sans-serif";var c=m[b];X.fillStyle=c;var d=a("COLOR_SCORE_IS",{color:a(c.toUpperCase()),score:""+I[b]});X.fillText(d,5+b*f/T.length,g-5)}}function C(a){return 0>=a?h/2:a>=k?g-h/2:a*h+h/2}function D(a,b){for(var c=0;c<a.length;c++){var d=a[c];X.beginPath(),X.moveTo(C(d.x1),C(d.y1)),X.lineTo(C(d.x2),C(d.y2)),X.lineWidth=h,X.strokeStyle=n[b],X.lineCap="round",X.stroke()}}function E(a,b){var d=W.offsetLeft+c.offsetLeft,e=W.offsetTop+c.offsetTop,f=c.offsetWidth,g=c.offsetHeight,h=(a-d)/f*j,i=(b-e)/g*k;return{x:Math.floor(h),y:Math.floor(i)}}function F(a,b){a.preventDefault(),"touchend"===b&&null!==M&&(N=!0);var c=a.targetTouches[0];if(c){var d=E(c.pageX,c.pageY);if(!(d.x>=k)){if(null===Y||null===Z)return Y=d.x,void(Z=d.y);$=d.x,_=d.y;var e=$-Y,f=_-Z,g=null,h=Math.abs(e),i=Math.abs(f),l=Math.min(h,i);(h>0||i>0)&&(i>2*h?($=Y,_=0>_?0:_>j-1?j-1:_,g=f>0?"N":"S"):h/2>i?(_=Z,g=e>0?"E":"W"):e>0?f>0?($=Y+l,_=Z+l,g="NE"):($=Y+l,_=Z-l,g="SE"):f>0?($=Y-l,_=Z+l,g="NW"):($=Y-l,_=Z-l,g="SW"),M={x1:Y,y1:Z,x2:$,y2:_})}}}b.info("createCanvasController for canvas.id="+c.id);var G,H,I,J,K,L,M,N,O,P,Q,R=!1,S=!1,T=null,U=null,V=null,W=document.getElementById("gameArea"),X=c.getContext("2d"),Y=null,Z=null,$=null,_=null;return c.addEventListener("touchstart",function(a){Y=null,Z=null,$=null,_=null,F(a,"touchstart")},!1),c.addEventListener("touchmove",function(a){F(a,"touchmove")},!1),c.addEventListener("touchend",function(a){F(a,"touchend")},!1),{gotStartMatch:e,gotMessage:p,gotEndMatch:q}}var f=390,g=300,h=30,i=30,j=f/h,k=g/i,l=120,m=["blue","red","brown","purple","pink","yellow","orange","silver"],n=["rgba(0, 0, 255, .4)","rgba(255, 0, 0, .4)","rgba(139, 69, 19, .4)","rgba(128, 0, 128, .4)","rgba(255, 192, 203, .4)","rgba(255, 255, 0, .4)","rgba(255, 165, 0, .4)","rgba(192, 192, 192, .4)"],o=["alligator","ant","bear","bee","bird","camel","cat","cheetah","chicken","chimpanzee","cow","crocodile","deer","dog","dolphin","duck","eagle","elephant","fish","fly","fox","frog","giraffe","goat","goldfish","hamster","hippo","horse","kangaroo","kitten","lion","lobster","monkey","octopus","owl","panda","pig","puppy","rabbit","rat","scorpion","seal","shark","sheep","snail","snake","spider","squirrel","tiger","turtle","wolf","zebra"];c.init({createCanvasController:e,canvasWidth:f,canvasHeight:g})}]);
//# sourceMappingURL=index.min.js.map