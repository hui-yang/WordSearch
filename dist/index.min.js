angular.module("myApp",["ngTouch","ui.bootstrap"]).run(["$translate","$log","realTimeService","randomService",function(a,b,c,d){"use strict";function e(c){function e(a){T=a.yourPlayerIndex,S=a.playersInfo,U=a.matchController,Q=!0,R=1===S.length,J=0,K=[],G=[],I=[],M=null,N=!1,O=[];for(var b=0;b<S.length;b++)G[b]=[],I[b]=0;H=G[T],y(o),L=(new Date).getTime(),t()}function i(a){for(var b=0;b<K.length;b++)if(a.x1===K[b].x1&&a.y1===K[b].y1&&a.x2===K[b].x2&&a.y2===K[b].y2)return b;return-1}function p(a){var b=a.fromPlayerIndex,c=a.message,d=angular.fromJson(c);G[b].push(d.a),I[b]=d.s;var e=i(d.a);K[e].found||(K[e].found=!0,J--)}function q(a){I=a,Q=!1,u()}function r(a){if(!R&&Q){var b=angular.toJson({s:I[T],a:{x1:X,y1:Y,x2:Z,y2:$}});a?U.sendReliableMessage(b):U.sendUnreliableMessage(b)}}function s(){Q&&(Q=!1,U.endMatch(I))}function t(){u(),P=setInterval(z,l)}function u(){clearInterval(P)}function v(a){switch(a){case 0:return{dx:0,dy:1};case 1:return{dx:1,dy:1};case 2:return{dx:1,dy:0};case 3:return{dx:1,dy:-1};case 4:return{dx:0,dy:-1};case 5:return{dx:-1,dy:-1};case 6:return{dx:-1,dy:0};case 7:return{dx:-1,dy:1}}}function w(a){var b,c,e,f,g,h,i,j,l=!1,m=0,n=200;if(!(a.length>k)){for(;!l;){b=d.randomFromTo(J+10*(3*m+1),0,k),c=d.randomFromTo(J+10*(3*m+2),0,k),i=d.randomFromTo(J+10*(3*m+3),0,8);var o=v(i);if(g=o.dx,h=o.dy,e=b+g*(a.length-1),f=c+h*(a.length-1),m++,m>n)return;if(!(f>=k||0>f||e>=k||0>e)){j=!1;for(var p=b,q=c,r=0;r<a.length;r++)""!==O[p][q]&&O[p][q]!==a.substring(r,r+1)&&(j=!0),p+=g,q+=h;if(!j){for(p=b,q=c,r=0;r<a.length;r++)O[p][q]=a.substring(r,r+1).toUpperCase(),p+=g,q+=h;l=!0}}}return{x1:b,y1:c,x2:e,y2:f}}}function x(){var a,b,c=6020;for(a=0;k>a;a++)for(b=0;k>b;b++)""===O[a][b]&&(O[a][b]=String.fromCharCode(d.randomFromTo(c,65,90)).toUpperCase(),c++)}function y(a){var c,e,f;for(c=0;k>c;c++)for(O[c]=[],e=0;k>e;e++)O[c][e]="";for(var g=d.randomFromTo(J,0,a.length),h=0,i=g;h<a.length&&10>J;h++){var j=a[i].toLowerCase().replace(/\s/,"");if(f=w(j)){var l={x1:f.x1,y1:k-1-f.y1,x2:f.x2,y2:k-1-f.y2,content:a[i],found:!1};K.push(l),b.info(l),J++,i=(i+1)%a.length}else i=(i+1)%a.length}x()}function z(){if(Q){var b=Math.floor(((new Date).getTime()-L)/1e3);if(3>b){B();var c=3-b,d=m[T];W.fillStyle=d,W.font="80px sans-serif",W.fillText(""+c,f/2,g/2),W.font="20px sans-serif";var e=a("YOUR_PLAYER_COLOR_IS",{color:a(d.toUpperCase())});return void W.fillText(e,f/4-30,g/4-30)}B();var h;if(null!==M&&(h=M,D([h],T)),N){M=null,N=!1;var j=i(h);if(-1===j)return;if(K[j].found)return;K[j].found=!0,J--,I[T]++,H=G[T],H.push(h),G[T]=H,r(!0),0===J&&s(),B()}}}function A(){var a,b;W.font="20px monospace",W.fillStyle="#8B7355",W.textBaseline="middle";for(var c=0;k>c;c++){b=(k-c)*h-h/2;for(var d=0;k>d;d++){a=d*h+h/4;var e=O[d][c];W.fillText(e,a,b)}}a=(k+.25)*h;for(var f=0;f<K.length;f++)b=f*h+h/2,W.font=K[f].found?"italic 12px Arial":"bold 12px Arial",W.fillStyle=K[f].found?"#CDAA7D":"#8B7355",W.fillText(K[f].content,a,b)}function B(){W.fillStyle="#F5F5DC",W.fillRect(0,0,f,g),W.strokeStyle="#8B4513",W.lineWidth=2,W.strokeRect(0,0,g,g),W.strokeRect(g,0,f-g,g),A();var b;for(b=0;b<G.length;b++)b!==T&&D(G[b],b);for(D(H,T),b=0;b<I.length;b++){W.font="12px sans-serif";var c=m[b];W.fillStyle=c;var d=a("COLOR_SCORE_IS",{color:a(c.toUpperCase()),score:""+I[b]});W.fillText(d,5+b*f/S.length,g-5)}}function C(a){return 0>=a?h/2:a>=k?g-h/2:a*h+h/2}function D(a,b){for(var c=0;c<a.length;c++){var d=a[c];W.beginPath(),W.moveTo(C(d.x1),C(d.y1)),W.lineTo(C(d.x2),C(d.y2)),W.lineWidth=h,W.strokeStyle=n[b],W.lineCap="round",W.stroke()}}function E(a,b){var d=V.offsetLeft+c.offsetLeft,e=V.offsetTop+c.offsetTop,f=c.offsetWidth,g=c.offsetHeight,h=(a-d)/f*j,i=(b-e)/g*k;return{x:Math.floor(h),y:Math.floor(i)}}function F(a,b){a.preventDefault(),"touchend"===b&&null!==M&&(N=!0);var c=a.targetTouches[0];if(c){var d=E(c.pageX,c.pageY);if(!(d.x>=k)){if(null===X||null===Y)return X=d.x,void(Y=d.y);Z=d.x,$=d.y;var e=Z-X,f=$-Y,g=null,h=Math.abs(e),i=Math.abs(f),l=Math.min(h,i);(h>0||i>0)&&(i>2*h?(Z=X,$=0>$?0:$>j-1?j-1:$,g=f>0?"N":"S"):h/2>i?($=Y,g=e>0?"E":"W"):e>0?f>0?(Z=X+l,$=Y+l,g="NE"):(Z=X+l,$=Y-l,g="SE"):f>0?(Z=X-l,$=Y+l,g="NW"):(Z=X-l,$=Y-l,g="SW"),M={x1:X,y1:Y,x2:Z,y2:$})}}}b.info("createCanvasController for canvas.id="+c.id);var G,H,I,J,K,L,M,N,O,P,Q=!1,R=!1,S=null,T=null,U=null,V=document.getElementById("gameArea"),W=c.getContext("2d"),X=null,Y=null,Z=null,$=null;return c.addEventListener("touchstart",function(a){X=null,Y=null,Z=null,$=null,F(a,"touchstart")},!1),c.addEventListener("touchmove",function(a){F(a,"touchmove")},!1),c.addEventListener("touchend",function(a){F(a,"touchend")},!1),{gotStartMatch:e,gotMessage:p,gotEndMatch:q}}var f=390,g=300,h=30,i=30,j=f/h,k=g/i,l=120,m=["blue","red","brown","purple","pink","yellow","orange","silver"],n=["rgba(0, 0, 255, .4)","rgba(255, 0, 0, .4)","rgba(139, 69, 19, .4)","rgba(128, 0, 128, .4)","rgba(255, 192, 203, .4)","rgba(255, 255, 0, .4)","rgba(255, 165, 0, .4)","rgba(192, 192, 192, .4)"],o=["alligator","ant","bear","bee","bird","camel","cat","cheetah","chicken","chimpanzee","cow","crocodile","deer","dog","dolphin","duck","eagle","elephant","fish","fly","fox","frog","giraffe","goat","goldfish","hamster","hippo","horse","kangaroo","kitten","lion","lobster","monkey","octopus","owl","panda","pig","puppy","rabbit","rat","scorpion","seal","shark","sheep","snail","snake","spider","squirrel","tiger","turtle","wolf","zebra"];c.init({createCanvasController:e,canvasWidth:f,canvasHeight:g})}]);
//# sourceMappingURL=index.min.js.map